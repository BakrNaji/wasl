{% load static %}

<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <title>WoOx Travel Reservation Page</title>

    <!-- Bootstrap core CSS -->
    <link href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">

    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="{% static 'assets/css/fontawesome.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/templatemo-woox-travel.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/owl.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/animate.css' %}">
    <link rel="stylesheet"href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
<!--

TemplateMo 580 Woox Travel

https://templatemo.com/tm-580-woox-travel

-->
  </head>

<body>



{% include 'parts/preloader.html' %}
{% include 'parts/nav.html' %}

<div class="reservation-form">
    <div class="container">
      <div class="row" style="direction: rtl;">
        <div class="col-lg-12">
          <center>
          <div class="col-lg-12" style="background-color: #22b3c1; border-top-left-radius:30px; border-top-right-radius:30px; position:relative; padding:18px;">
            {% if photo_url %}
              <img src="{{ photo_url }}" alt="Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø´Ø®ØµÙŠØ©" style="width:96px;height:96px;border-radius:50%;object-fit:cover;border:3px solid #fff;position:absolute; right:16px; top:8px;"/>
            {% endif %}
            <h4 style="margin:0;">ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©</h4>
            {% if request.user.is_authenticated %}
              <button id="edit-profile-toggle" type="button" class="btn btn-light" style="position:absolute; left:16px; top:8px;">ØªØ¹Ø¯ÙŠÙ„</button>
            {% endif %}
          </div>
        </center>
          {% if request.user.is_authenticated %}
          <div id="edit-profile-section" style="display:none;">
          <form id="reservation-form" method="POST">
          {% csrf_token %}
            {% include 'parts/_alerts.html' %}
            <div class="row">
              

              <div class="col-lg-6">
                  <fieldset>
                      <label for="Name" class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø§ÙˆÙ„</label>
                      <input type="text" name="fname" class="Name" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø§ÙˆÙ„" value="{{fname}}" required>
                  </fieldset>
              </div>
              <div class="col-lg-6">
                <fieldset>
                    <label for="Name" class="form-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø§Ø®ÙŠØ±</label>
                    <input type="text" name="lname" class="Name" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„Ø§Ø®ÙŠØ±" value="{{lname}}" required>
                </fieldset>
                </div>
                
    
                  <div class="col-lg-6">
                    <fieldset>
                        <label for="Name" class="form-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
                        <input type="text" name="address" required value="{{address}}">
                    </fieldset>
                    </div>
                <div class="col-lg-6">
                    <fieldset>
                        <label for="Name" class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                        <input type="text" name="user" class="Name" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" value="{{user}}" required readonly>
                    </fieldset>
                    </div>
                    <div class="col-lg-6">
                        <fieldset>
                            <label for="Name" class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                            <input type="email" name="email" placeholder="name@example.com" required value="{{email}}" readonly>
                        </fieldset>
                        </div>
                      <div class="col-lg-6">
                        <fieldset>
                          <label for="branch" class="form-label">Ø§Ù„ÙØ±Ø¹</label>
                          <input type="text" name="branch" value="{{ branch }}">
                        </fieldset>
                      </div>
                      <div class="col-lg-6">
                        <fieldset>
                          <label for="department" class="form-label">Ø§Ù„Ù‚Ø³Ù…</label>
                          <input type="text" name="department" value="{{ department }}">
                        </fieldset>
                      </div>
                      <div class="col-lg-6">
                        <fieldset>
                          <label for="job_title" class="form-label">Ø§Ù„ÙˆØ¸ÙŠÙØ©</label>
                          <input type="text" name="job_title" value="{{ job_title }}">
                        </fieldset>
                      </div>
              <!-- <div class="col-lg-6">
                <fieldset>
                    <label for="Number" class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                    <input type="text" name="Number" class="Number" placeholder="7xxxxxxxx" autocomplete="on" required>
                </fieldset>
              </div> -->
              <div class="border-button"><a href="{% url 'change_password' %}">ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</a></div>
              <div class="col-lg-12">                        
                  <fieldset>
                      <button type="submit" name="btnsave" class="main-button">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
                  </fieldset>
              </div>
            </div>
          </form>
          </div>
          {% if evaluations %}
          <div class="col-lg-12" style="margin-top:20px;">
            <h4>ØªÙ‚ÙŠÙŠÙ…Ø§ØªÙŠ</h4>
            {% if average_evaluation %}
              <p>Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¹Ø§Ù…: <strong>{{ average_evaluation }}</strong> / 5</p>
            {% endif %}
            <div class="evaluations-list">
              {% for ev in evaluations %}
                <div class="card" style="padding:10px; margin-bottom:10px;">
                  <p><strong>Ø§Ù„Ù…Ù‚ÙŠÙ‘Ù…:</strong> {% if ev.evaluator %}{{ ev.evaluator.user.username }}{% else %}N/A{% endif %}</p>
                  <p><strong>Ø§Ù„Ù‚Ø³Ù…:</strong> {{ ev.department }} &nbsp; <strong>Ø§Ù„ÙØ±Ø¹:</strong> {{ ev.branch }}</p>
                  <p><strong>Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø¹Ø§Ù…Ø©:</strong> {{ ev.overall_score }} / 5</p>
                  <p><strong>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong> {{ ev.comment }}</p>
                  <p style="font-size:12px;color:#666;">{{ ev.created_at }}</p>
                </div>
              {% empty %}
                <p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†.</p>
              {% endfor %}
            </div>
          </div>
          {% endif %}
         
           <!-- Owner Evaluations Section -->
           {% if is_owner and owner_evaluations %}
           <div class="col-lg-12" style="margin-top:30px;">
             <div class="card" style="border-radius:12px; padding:25px; box-shadow:0 4px 12px rgba(0,0,0,0.1); border-top:4px solid #235E88;">
               <h4 style="color:#235E88; font-weight:700; margin-bottom:20px; display:flex; align-items:center; gap:10px;">ğŸ“Š Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„ØªÙŠ Ø£Ø¶ÙØªÙ‡Ø§</h4>
             
               <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:15px;">
                 {% for ev in owner_evaluations %}
                 <div class="card" style="border-radius:10px; border-left:4px solid #F2A23F; padding:15px; background:#f8f9fa; transition:all 0.2s;" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 6px 16px rgba(0,0,0,0.1)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.05)';">
                   <div style="display:flex; justify-content:space-between; align-items:start; margin-bottom:12px;">
                     <div>
                       <h5 style="color:#235E88; margin:0; font-weight:700;">ğŸ‘¤ {{ ev.investor.user.username }}</h5>
                       <small style="color:#666;">{{ ev.created_at|date:'d/m/Y H:i' }}</small>
                     </div>
                     <div style="background:#F2A23F; color:#fff; padding:8px 12px; border-radius:6px; font-weight:700; font-size:18px;">â­ {{ ev.compute_overall|default:'0' }}/5</div>
                   </div>
                 
                   <p style="margin:8px 0; color:#666; font-size:14px;"><strong>ğŸ“ Ø§Ù„ÙØ±Ø¹:</strong> {{ ev.branch|default:'---' }}</p>
                   <p style="margin:8px 0; color:#666; font-size:14px;"><strong>ğŸ¢ Ø§Ù„Ù‚Ø³Ù…:</strong> {{ ev.department|default:'---' }}</p>
                 
                   {% if ev.comment %}
                   <div style="background:#fff; padding:10px; border-radius:6px; margin-top:10px; border-right:3px solid #235E88;">
                     <small style="color:#999; display:block; margin-bottom:5px;">ğŸ’¬ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</small>
                     <p style="margin:0; color:#555; font-size:14px;">{{ ev.comment }}</p>
                   </div>
                   {% endif %}
                 
                   {% if ev.image_set.all %}
                   <div style="display:flex; gap:8px; margin-top:10px; flex-wrap:wrap;">
                     {% for img in ev.image_set.all %}
                     <a href="{{ img.image.url }}" target="_blank" style="display:inline-block; width:50px; height:50px; border-radius:6px; overflow:hidden; border:2px solid #ddd;">
                       <img src="{{ img.image.url }}" style="width:100%; height:100%; object-fit:cover;" />
                     </a>
                     {% endfor %}
                   </div>
                   {% endif %}
                 
                   <div style="margin-top:12px; padding-top:12px; border-top:1px solid #ddd;">
                     <span style="background:{% if ev.status == 'approved' %}#28a745{% elif ev.status == 'pending' %}#ffc107{% else %}#dc3545{% endif %}; color:#fff; padding:4px 10px; border-radius:4px; font-size:12px; font-weight:600;">
                       {% if ev.status == 'approved' %}âœ“ Ù…Ø¹ØªÙ…Ø¯{% elif ev.status == 'pending' %}â³ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©{% else %}âœ— Ù…Ø±ÙÙˆØ¶{% endif %}
                     </span>
                   </div>
                 </div>
                 {% empty %}
                 <p style="color:#999; text-align:center; grid-column:1/-1;">Ù„Ù… ØªØ¶Ù Ø£ÙŠ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯.</p>
                 {% endfor %}
               </div>
             </div>
           </div>
           {% endif %}
          {% else %}
          <h4 class="alert alert-danger">
              ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ 
              <a href="{% url 'login' %}">
                  ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
              </a>
          </h4>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

{% include 'parts/footer.html' %}


  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="{% static 'vendor/jquery/jquery.min.js' %}"></script>
  <script src="{% static 'vendor/bootstrap/js/bootstrap.min.js' %}"></script>

  <script src="{% static 'assets/js/isotope.min.js' %}"></script>
  <script src="{% static 'assets/js/owl-carousel.js' %}"></script>
  <script src="{% static 'assets/js/wow.js' %}"></script>
  <script src="{% static 'assets/js/tabs.js' %}"></script>
  <script src="{% static 'assets/js/popup.js' %}"></script>
  <script src="{% static 'assets/js/custom.js' %}"></script>

  <script>
    $(".option").click(function(){
      $(".option").removeClass("active");
      $(this).addClass("active"); 
    });
  </script>

  <script>
    (function($){
      $(document).ready(function(){
        var $toggle = $('#edit-profile-toggle');
        var $section = $('#edit-profile-section');
        if($toggle.length && $section.length){
          $toggle.on('click', function(){
            $section.slideToggle(200);
            // change button text
            var txt = $toggle.text().trim();
            $toggle.text(txt === 'ØªØ¹Ø¯ÙŠÙ„' ? 'Ø¥Ù„ØºØ§Ø¡' : 'ØªØ¹Ø¯ÙŠÙ„');
          });
        }
      });
    })(jQuery);
  </script>

  </body>

</html>
